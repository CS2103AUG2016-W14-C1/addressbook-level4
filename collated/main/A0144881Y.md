# A0144881Y
###### /java/seedu/manager/logic/commands/DeleteCommand.java
``` java
public class DeleteCommand extends Command {

    public static final String COMMAND_WORD = "delete";
    
    public static final String USAGE = "delete INDEX";
    
    public static final String EXAMPLES = "delete 1";
    
    public static final String MESSAGE_USAGE = COMMAND_WORD
            + ": Deletes the activity identified by the index number used in the last activity listing.\n"
            + "Parameters: INDEX (must be a positive integer)\n"
            + "Example: " + COMMAND_WORD + " 1";

    public static final String MESSAGE_DELETE_ACTIVITY_SUCCESS = "Deleted Activity: %1$s";

    public final int targetIndex;

    public DeleteCommand(int targetIndex) {
        this.targetIndex = targetIndex;
    }


    @Override
    public CommandResult execute() {

        UnmodifiableObservableList<Activity> lastShownList = model.getFilteredActivityList();

        if (lastShownList.size() < targetIndex) {
            indicateAttemptToExecuteIncorrectCommand();
            return new CommandResult(Messages.MESSAGE_INVALID_ACTIVITY_DISPLAYED_INDEX);
        }

        Activity activityToDelete = lastShownList.get(targetIndex - 1);
        
        model.deleteActivity(activityToDelete);

        return new CommandResult(String.format(MESSAGE_DELETE_ACTIVITY_SUCCESS, activityToDelete.getName()));
    }

}
```
###### /java/seedu/manager/logic/commands/RedoCommand.java
``` java
public class RedoCommand extends Command {
	
    public static final String COMMAND_WORD = "redo";

    public static final String USAGE = "redo\n" + "redo NUMBER_OF_TIMES";

    public static final String EXAMPLES = "redo\n" + "redo 2";
    
    public static final String MESSAGE_USAGE = COMMAND_WORD + ": Can only be used right after undo commands, to revert the to-do list to the state before undo.\n"
              + "\nUsage:\nredo [NUMBER_OF_COMMANDS]\n";

    public static final String MESSAGE_SUCCESS = "Reverted to later state. (%d commands redone)";
    
    public static final String MESSAGE_INDEX_LARGER_THAN_MAX = "Nothing left to redo. You are at the latest state.";
    
    public static final String MESSAGE_OFFSET_OUT_OF_BOUNDS = "Insufficient number of commands to perform redo operation. You can redo maximum %d times.";
    
    private int offset = 0;
	
    
    public RedoCommand() {
        offset = 1;
    }
    
    public RedoCommand(int newOffset) {
        offset = newOffset;
    }
    
    @Override
    public CommandResult execute() {
        assert model != null;
        if (model.getHistoryIndex() >= model.getMaxHistoryIndex()) {
            return new CommandResult(MESSAGE_INDEX_LARGER_THAN_MAX);
        } else if (model.getHistoryIndex() + offset > model.getMaxHistoryIndex()) {
            return new CommandResult(String.format(MESSAGE_OFFSET_OUT_OF_BOUNDS, model.getMaxHistoryIndex() - model.getHistoryIndex()));
        } else {
            model.redoCommand(offset);
            return new CommandResult(String.format(MESSAGE_SUCCESS, offset));
        }
    }

}
```
###### /java/seedu/manager/logic/commands/UpdateCommand.java
``` java
public class UpdateCommand extends Command {
	public static final String COMMAND_WORD = "update";

	public static final String USAGE = "update ACTIVITY_ID NEW_NAME\n" +
	                                   "update ACTIVITY_ID NEW_NAME on DATE_TIME\n" +
	                                   "update ACTIVITY_ID NEW_NAME from DATE_TIME to DATE_TIME\n";

	public static final String EXAMPLES = "update 1 Walk the dog\n" +
                                          "update 2 New homework deadline on 17 Nov\n" +
                                          "update 3 Postponed talk from 2 Nov 3pm to 2 Nov 5pm\n";

	
	public static final String MESSAGE_USAGE = COMMAND_WORD
            + ": Updates the activity identified by the index number used in the last activity listing.\n"
            + "Parameters: INDEX (must be a positive integer)\n"
            + "Example: " + COMMAND_WORD + " 1" + " assignment1";

    public static final String MESSAGE_UPDATE_ACTIVITY_SUCCESS = "Updated Activity: %1$s";
	public final int targetIndex;
	public final String newName;
	public String newDateTime;
	public String newEndDateTime;

	/**
	 * Constructor for updating name only
	 */
	public UpdateCommand(int targetIndex, String newName) {
		this.targetIndex = targetIndex;
		this.newName = newName;
		this.newDateTime = null;
		this.newEndDateTime = null;
	}
	
	/**
	 * Constructor for updating name and dateTime
	 */
	public UpdateCommand(int targetIndex, String newName, String dateTime) {
		this(targetIndex, newName);
		this.newDateTime = dateTime;
	}
	
	/**
	 * Constructor for updating name, dateTime and endDateTime
	 */
	public UpdateCommand(int targetIndex, String newName, String dateTime, String endDateTime) {
		this(targetIndex, newName);
		this.newDateTime = dateTime;
		this.newEndDateTime = endDateTime;
	}
	
	@Override
	public CommandResult execute() {
		UnmodifiableObservableList<Activity> lastShownList = model.getFilteredActivityList();

        if (lastShownList.size() < targetIndex) {
            indicateAttemptToExecuteIncorrectCommand();
            return new CommandResult(Messages.MESSAGE_INVALID_ACTIVITY_DISPLAYED_INDEX);
        }

        Activity activityToUpdate = lastShownList.get(targetIndex - 1);
        model.updateActivity(activityToUpdate, newName, newDateTime, newEndDateTime);

        return new CommandResult(String.format(MESSAGE_UPDATE_ACTIVITY_SUCCESS, activityToUpdate.getName()));
    }
}

```
###### /java/seedu/manager/logic/LogicManager.java
``` java
    public ObservableList<Activity> getFilteredActivitiesList() {
        return model.getFilteredActivityList();
    }

	@Override
```
###### /java/seedu/manager/logic/LogicManager.java
``` java
	public ObservableList<Activity> getFilteredDeadlineAndEventList() {
		return model.getFilteredDeadlineAndEventList();
	}

	@Override
```
###### /java/seedu/manager/logic/LogicManager.java
``` java
	public ObservableList<Activity> getFilteredFloatingActivityList() {
		return model.getFilteredFloatingActivityList();
	}
}
```
###### /java/seedu/manager/logic/parser/AMParser.java
``` java
    private Command prepareDelete(String args) {

        Optional<Integer> index = parseIndex(args);
        if(!index.isPresent()){
            return new IncorrectCommand(
            	String.format(MESSAGE_INVALID_COMMAND_FORMAT, DeleteCommand.MESSAGE_USAGE));
        }

        return new DeleteCommand(index.get());
    }
    
    /**
     * Parses arguments in the context of the update activity command.
     *
     * @param args full command args string
     * @return the prepared command
     */
```
###### /java/seedu/manager/logic/parser/AMParser.java
``` java
    private Command prepareRedo(String args) {
        // Validate index format
        Optional<Integer> index = parseIndex(args);
        if(index.isPresent()){
            return new RedoCommand(index.get());
        } else {
            return new RedoCommand();
        }
    }
    
    /**
     * Returns the specified index in the {@code command} IF a positive unsigned integer is given as the index.
     *   Returns an {@code Optional.empty()} otherwise.
     */
    private Optional<Integer> parseIndex(String command) {
        final Matcher matcher = ACTIVITY_INDEX_ARGS_FORMAT.matcher(command.trim());
        if (!matcher.matches()) {
            return Optional.empty();
        }

        String index = matcher.group("targetIndex");
        if(!StringUtil.isUnsignedInteger(index)){
            return Optional.empty();
        }
        return Optional.of(Integer.parseInt(index));

    }

    /**
     * Parses arguments in the context of the search command.
     *
     * @param args full command args string
     * @return the prepared command
     */
```
###### /java/seedu/manager/logic/parser/AMParser.java
``` java
    private Command prepareSearch(String args) {
        final Matcher matcher = KEYWORDS_ARGS_FORMAT.matcher(args.trim());
        if (!matcher.matches()) {
            return new IncorrectCommand(String.format(MESSAGE_INVALID_COMMAND_FORMAT, SearchCommand.MESSAGE_USAGE));
        }
        
        // keywords delimited by whitespace
        final String[] keywords = matcher.group("keywords").split("\\s+");
        final Set<String> keywordSet = new HashSet<>(Arrays.asList(keywords));
        SearchCommand searchCommand = new SearchCommand(keywordSet);
        
        // add dateTime range if dateTime is indicated in part of search
        if (StringUtil.isAMDate(args.trim())) {
            String[] searchTimeTokens = args.trim().split(" to ");
            if (searchTimeTokens.length == SEARCH_RANGE_TOKEN_COUNT) {
                searchCommand.addDateTimeRange(searchTimeTokens[0].trim(), searchTimeTokens[1].trim());
            } else {
                searchCommand.addDateTimeRange(searchTimeTokens[0].trim());
            }
        }
        
        if ("pending".equals(args.trim().toLowerCase()) || "completed".equals(args.trim().toLowerCase())) {
        	searchCommand.addStatus(args.trim().toLowerCase());
        }
        
        return searchCommand;
    }
    
```
###### /java/seedu/manager/model/activity/ActivityList.java
``` java
    public void remove(Activity toRemove) {
        assert toRemove != null;
        assert internalList.contains(toRemove);
        internalList.remove(toRemove);
        Collections.sort(internalList);
    }
    
    /**
     * Updates the equivalent activity in the list.
     */
```
###### /java/seedu/manager/model/activity/ActivityList.java
``` java
    public void update(Activity toUpdate, String newName, String newDateTime, String newEndDateTime) {
    	assert toUpdate != null;
    	assert internalList.contains(toUpdate);
    	
    	int toUpdateIndex = internalList.indexOf(toUpdate);
    	Activity toUpdateInList = internalList.get(toUpdateIndex);
    	// Update Activity name (if there is new name)
    	if (newName != null && !newName.equals("")) {
    	    toUpdateInList.setName(newName);
    	}
    	// Update task to event
    	if (newDateTime != null && newEndDateTime != null) {
    	    toUpdateInList.setType(ActivityType.EVENT);
    	    toUpdateInList.setDateTime(newDateTime);
    	    toUpdateInList.setEndDateTime(newEndDateTime);
    	// Update task to deadline
	    } else if (newDateTime != null) {
	        toUpdateInList.setType(ActivityType.DEADLINE);
    		toUpdateInList.setDateTime(newDateTime);
    		toUpdateInList.setEndDateTime(null);
    	}
    	Collections.sort(internalList);
    }
    
    /**
     * Marks the equivalent activity in the list as completed.
     */
```
###### /java/seedu/manager/model/ActivityManager.java
``` java
public class ActivityManager implements ReadOnlyActivityManager {

    private final ActivityList activities = new ActivityList();

    public ActivityManager() {}

    /**
     * Activities and Tags are copied into this activity manager
     */
    public ActivityManager(ReadOnlyActivityManager toBeCopied) {
        this(toBeCopied.getActivityList());
    }

    /**
     * Activities and Tags are copied into this activity manager
     */
    public ActivityManager(ActivityList activities) {
        resetData(activities.getInternalList());
    }

    public static ReadOnlyActivityManager getEmptyActivityManager() {
        return new ActivityManager();
    }

//// list overwrite operations

    public ObservableList<Activity> getActivities() {
        return activities.getInternalList();
    }

    public void setActivties(List<Activity> activities) {
        this.activities.getInternalList().setAll(activities);
    }

    public void resetData(Collection<? extends Activity> newActivities) {
        setActivties(new ArrayList<Activity>(newActivities));
    }

    public void resetData(ReadOnlyActivityManager newData) {
        resetData(newData.getActivityList().getInternalList());
    }

//// activity-level operations

    /**
     * Adds an activity to the activity manager.
     * Also checks the new acitivity's tags and updates {@link #tags} with any new tags found,
     * and updates the Tag objects in the activity to point to those in {@link #tags}.
     *
     */
    public void addActivity(Activity activity) {
        activities.add(activity);
    }

    public void removeActivity(Activity key) {
        activities.remove(key);
    }

    public void updateActivity(Activity key, String newName, String newDateTime, String newEndDateTime) {
    	activities.update(key, newName, newDateTime, newEndDateTime);
    }

    public void markActivity(Activity key) {
    	activities.mark(key);
    }
    
    public void unmarkActivity(Activity key) {
    	activities.unmark(key);
    }
    
    public void listActivities() {
    	activities.list();
    }

//// util methods

    @Override
    public String toString() {
        return activities.getInternalList().size() + " activities";
        // TODO: refine later
    }

    @Override
    public List<Activity> getListActivity() {
        return Collections.unmodifiableList(activities.getInternalList());
    }

    @Override
    public boolean equals(Object other) {
        return other == this // short circuit if same object
                || (other instanceof ActivityManager // instanceof handles nulls
                && this.toString().equals(other.toString()));
                // TODO: check if activities are actually equal
                /* this.activities.equals(((ActivityManager) other).getActivities()); */       
                
    }

    @Override
    public int hashCode() {
        // use this method for custom fields hashing instead of implementing your own
        return Objects.hash(activities);
    }

	@Override
	public ActivityList getActivityList() {
		return activities;
	}
	
	public FilteredList<Activity> getPendingActivityList() {
		return activities.getPendingInternalList();
	}
}
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public synchronized void deleteActivity(Activity target) {
        activityManager.removeActivity(target);
        updateFilteredListToShowAll();
        indicateActivityListPanelUpdate();
        indicateActivityManagerChanged();
        recordManagerHistory(activityManager);
    }

    @Override
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public synchronized void updateActivity(Activity activity, String newName, String newDateTime, String newEndDateTime) {
        activityManager.updateActivity(activity, newName, newDateTime, newEndDateTime);
        updateFilteredListToShowAll();
        indicateActivityManagerChanged();
        indicateActivityListPanelUpdate(activity);
        recordManagerHistory(activityManager);
    }

    @Override
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public int getMaxHistoryIndex() {
    	return managerHistory.size() - 1;
    }
    
    @Override
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public synchronized void redoCommand(int offset) {
        historyIndex += offset;
        activityManager = new ActivityManager(managerHistory.get(historyIndex));
        filteredActivities = new FilteredList<>(activityManager.getActivities());
        updateFilteredListToShowAll();
        indicateActivityListPanelUpdate();
        indicateActivityManagerChanged();
    }
    
    @Override
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public UnmodifiableObservableList<Activity> getFilteredDeadlineAndEventList() {
    	FilteredList<Activity> deadlineAndEventList = filteredActivities.filtered(new Predicate<Activity>() {
    		public boolean test(Activity activity) {
    			return activity.getType() != ActivityType.FLOATING;
    		}
		});
    	return new UnmodifiableObservableList<>(deadlineAndEventList);
    }
    
    @Override
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public UnmodifiableObservableList<Activity> getFilteredFloatingActivityList() {
    	FilteredList<Activity> deadlineAndEventList = filteredActivities.filtered(new Predicate<Activity>() {
    		public boolean test(Activity activity) {
    			return activity.getType() == ActivityType.FLOATING;
    		}
		});
    	return new UnmodifiableObservableList<>(deadlineAndEventList);
    }

    @Override
    public void updateFilteredListToShowAll() {
        filteredActivities.setPredicate(null);
    }

    @Override
    public void updateFilteredActivityList(Set<String> keywords){
        updateFilteredActivityList(new PredicateExpression(new NameQualifier(keywords)));
    }
    
```
###### /java/seedu/manager/model/ModelManager.java
``` java
    public void updateFilteredActivityList(AMDate dateTime, AMDate endDateTime){
        updateFilteredActivityList(new PredicateExpression(new DateQualifier(dateTime, endDateTime)));
    }
    

    private void updateFilteredActivityList(Expression expression) {
        filteredActivities.setPredicate(expression::satisfies);
        indicateActivityListPanelUpdate();
    }
    
    private void updateFilteredActivityList(Predicate<Activity> predicate) {
        filteredActivities.setPredicate(predicate);
        indicateActivityListPanelUpdate();
    }
    
    public void updateFilteredActivityList() {
    	updateFilteredActivityList(new Predicate<Activity>() {
    		public boolean test(Activity activity) {
    			return !activity.getStatus().isCompleted();
    		}
    	});
    }
    
```
###### /java/seedu/manager/ui/ActivityListPanel.java
``` java
        protected void updateItem(Activity activity, boolean empty) {
            super.updateItem(activity, empty);

            if (empty || activity == null) {
                setGraphic(null);
                setText(null);
            } else {
                setGraphic(ActivityCard.load(activity, getIndex() + 1 + indexOffset).getLayout());
            }
        }
    }

}
```
###### /java/seedu/manager/ui/FloatingListPanel.java
``` java
        protected void updateItem(Activity activity, boolean empty) {
            super.updateItem(activity, empty);

            if (empty || activity == null) {
                setGraphic(null);
                setText(null);
            } else {
                setGraphic(ActivityCard.load(activity, getIndex() + 1 + indexOffset).getLayout());
            }
        }
    }
}

```
###### /java/seedu/manager/ui/MainWindow.java
``` java
    public void fillInnerParts() {
        activityListPanel = ActivityListPanel.load(primaryStage, getActivityListPlaceholder(), logic.getFilteredDeadlineAndEventList(), 0);
        floatingActivityListPanel = FloatingListPanel.load(primaryStage, getFloatingActivityListPlaceholder(), logic.getFilteredFloatingActivityList(), logic.getFilteredDeadlineAndEventList().size());
        resultDisplay = ResultDisplay.load(primaryStage, getResultDisplayPlaceholder());
        statusBarFooter = StatusBarFooter.load(primaryStage, getStatusbarPlaceholder(), config.getActivityManagerFilePath());
        commandBox = CommandBox.load(primaryStage, getCommandBoxPlaceholder(), resultDisplay, logic);
    }

    private AnchorPane getCommandBoxPlaceholder() {
        return commandBoxPlaceholder;
    }

    private AnchorPane getStatusbarPlaceholder() {
        return statusbarPlaceholder;
    }

    private AnchorPane getResultDisplayPlaceholder() {
        return resultDisplayPlaceholder;
    }

    public AnchorPane getActivityListPlaceholder() {
        return activityListPanelPlaceholder;
    }
    
```
###### /resources/view/MainWindow.fxml
``` fxml
<VBox maxHeight="Infinity" maxWidth="Infinity" minHeight="-Infinity" minWidth="-Infinity" xmlns="http://javafx.com/javafx/8.0.60" xmlns:fx="http://javafx.com/fxml/1" fx:controller="seedu.manager.ui.MainWindow">
   <stylesheets>
      <URL value="@DarkTheme.css" />
      <URL value="@Extensions.css" />
   </stylesheets>
   <children>
      <SplitPane id="splitPane" fx:id="splitPane" dividerPositions="0.5" orientation="vertical" VBox.vgrow="ALWAYS">
         <items>
            <VBox fx:id="activityList" prefWidth="340">
				<children>
					<Label fx:id="label1" style="-fx-text-fill: #0D47A1" text="Schedule" wrapText="true" />    
				</children>
                <padding>
                    <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                </padding>
               <children>
                  <AnchorPane fx:id="activityListPanelPlaceholder" VBox.vgrow="ALWAYS" />
               </children>
            </VBox>
            <VBox fx:id="floatingActivityList" prefWidth="340">
            	<children>
            		<Label fx:id="label2" style="-fx-text-fill: #0D47A1" text="Task" wrapText="true" />  
            	</children>
            	<padding>
                    <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                </padding>
               	<children>
                  <AnchorPane fx:id="floatingActivityListPanelPlaceholder" prefHeight="200.0" prefWidth="200.0" />
              	 </children>
            </VBox>
         </items>
      </SplitPane>
      <AnchorPane fx:id="resultDisplayPlaceholder" styleClass="anchor-pane" VBox.vgrow="NEVER">
           <padding>
               <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
           </padding>
       </AnchorPane>
      <AnchorPane fx:id="commandBoxPlaceholder" styleClass="anchor-pane" VBox.vgrow="NEVER">
         <padding>
            <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
         </padding>
      </AnchorPane>
      <AnchorPane fx:id="statusbarPlaceholder" VBox.vgrow="NEVER" />
   </children>
</VBox>
```
